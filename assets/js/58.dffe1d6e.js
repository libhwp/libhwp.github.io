(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{308:function(t,e,_){"use strict";_.r(e);var v=_(37),a=Object(v.a)({},function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"배포용-문서-데이터"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#배포용-문서-데이터","aria-hidden":"true"}},[t._v("#")]),t._v(" 배포용 문서 데이터")]),t._v(" "),_("div",{staticClass:"tip custom-block"},[_("p",{staticClass:"custom-block-title"},[t._v("Tag ID")]),t._v(" "),_("p",[t._v("HWPTAG_DISTRIBUTE_DOC_DATA")])]),t._v(" "),_("p",[t._v("배포용 문서는 문서를 배포할 시 원본 문서의 일반적인 편집을 제한하기 위해서 설계된 기능입니다.")]),t._v(" "),_("p",[t._v("그 외에도 "),_("code",[t._v("복사")]),t._v("/"),_("code",[t._v("붙이기")]),t._v(", "),_("code",[t._v("인쇄")]),t._v("를 제한하는 설정을 할 수 있습니다.")]),t._v(" "),_("p",[t._v("배포용문서와 일반 문서는 아래와 같은 차이점을 가집니다.")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",{staticStyle:{"text-align":"center"}}),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("배포용문서")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("일반문서")])])]),t._v(" "),_("tbody",[_("tr",[_("td",{staticStyle:{"text-align":"center"}},[t._v("본문 스트림")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("ViewText")]),t._v("/"),_("code",[t._v("Section")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("BodyText")]),t._v("/"),_("code",[t._v("Section")])])]),t._v(" "),_("tr",[_("td",{staticStyle:{"text-align":"center"}},[t._v("암호화 여부")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("⭕️")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("❌")])]),t._v(" "),_("tr",[_("td",{staticStyle:{"text-align":"center"}},[t._v("비고")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("복사, 인쇄제한을 위한 플래그")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}})])])]),t._v(" "),_("p",[t._v("배포용 문서는 본문 스트림을 암호화하고 있으며, 이 외에도 아래와 같은 스트림을 암호화 합니다.")]),t._v(" "),_("ul",[_("li",[_("code",[t._v("ViewText/Section0")]),t._v(" ... "),_("code",[t._v("N")])]),t._v(" "),_("li",[_("code",[t._v("Scripts/JScriptVersion")])]),t._v(" "),_("li",[_("code",[t._v("Scripts/DefaultScript")])]),t._v(" "),_("li",[_("code",[t._v("DocHistory/HistoryLastDoc")])]),t._v(" "),_("li",[_("code",[t._v("DocHistory/VersionLog0")]),t._v(" ... "),_("code",[t._v("N")])])]),t._v(" "),_("h2",{attrs:{id:"데이터-표"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#데이터-표","aria-hidden":"true"}},[t._v("#")]),t._v(" 데이터 표")]),t._v(" "),_("p",[_("code",[t._v("문서 임의의 데이터")]),t._v("을 나타냅니다.")]),t._v(" "),_("p",[_("code",[t._v("libhwp")]),t._v("에서 "),_("code",[t._v("UnknownRecord")]),t._v("객체로 표현됩니다.")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",{staticStyle:{"text-align":"center"}},[t._v("자료형")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("길이")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("타입")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("변수")]),t._v(" "),_("th",[t._v("설명")])])]),t._v(" "),_("tbody",[_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("BYTE array[256]")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("256")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",[t._v("배포용 문서 데이터")])]),t._v(" "),_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("전체 길이")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"4"}},[_("strong",[_("code",[t._v("256")])])])])])]),t._v(" "),_("h2",{attrs:{id:"배포용-문서-레코드"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#배포용-문서-레코드","aria-hidden":"true"}},[t._v("#")]),t._v(" 배포용 문서 레코드")]),t._v(" "),_("p",[_("code",[t._v("배포용 문서 레코드")]),t._v("를 나타냅니다.")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",{staticStyle:{"text-align":"center"}},[t._v("자료형")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("길이")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("타입")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("변수")]),t._v(" "),_("th",[t._v("설명")])])]),t._v(" "),_("tbody",[_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("WCHAR array[40]")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("80")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",[t._v("- 배포용 문서를 생성시 사용된 암호의 "),_("code",[t._v("SHA1")]),t._v("해시코드"),_("br"),t._v(" - 암복호화용 키 (처음부터 "),_("code",[t._v("16")]),t._v("바이트 까지)")])]),t._v(" "),_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("WCHAR")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("2")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",[t._v("배포용 문서 옵션 flag "),_("br"),t._v(" "),_("code",[t._v("0x01")]),t._v(" = 복사방지 "),_("br"),t._v(" "),_("code",[t._v("0x02")]),t._v(" = 인쇄 방지")])]),t._v(" "),_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("전체 길이")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"4"}},[_("strong",[_("code",[t._v("82")])])])])])]),t._v(" "),_("h2",{attrs:{id:"배포용-문서-데이터-복호화"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#배포용-문서-데이터-복호화","aria-hidden":"true"}},[t._v("#")]),t._v(" 배포용 문서 데이터 복호화")]),t._v(" "),_("p",{attrs:{align:"center"}},[_("img",{attrs:{src:"/images/hwp/docinfo/distribute/decryption.png"}})]),t._v(" "),_("h2",{attrs:{id:"seed-찾기"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#seed-찾기","aria-hidden":"true"}},[t._v("#")]),t._v(" Seed 찾기")]),t._v(" "),_("p",[t._v("복호화 과정에 필요한 "),_("code",[t._v("Seed")]),t._v("값은 "),_("code",[t._v("배포용 문서 데이터")]),t._v("의 처음 "),_("code",[t._v("4")]),t._v("바이트입니다.")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",{staticStyle:{"text-align":"center"}},[t._v("자료형")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("길이")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("타입")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("변수")]),t._v(" "),_("th",[t._v("설명")])])]),t._v(" "),_("tbody",[_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("UINT")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("code",[t._v("4")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("-")]),t._v(" "),_("td",[t._v("Seed (배포용 문서 데이터의 첫 "),_("code",[t._v("4")]),t._v("바이트)")])]),t._v(" "),_("tr",[_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("전체 길이")])]),t._v(" "),_("td",{staticStyle:{"text-align":"center"},attrs:{colspan:"4"}},[_("strong",[_("code",[t._v("4")])])])])])]),t._v(" "),_("h2",{attrs:{id:"난수-배열-만들기"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#난수-배열-만들기","aria-hidden":"true"}},[t._v("#")]),t._v(" 난수 배열 만들기")]),t._v(" "),_("p",[t._v("배포용 문서 데이터에서 해시코드를 추출하기 위해서는 우선 특정패턴을 지닌 난수배열을 생성해야 합니다.\n이때 패턴을 생성하기 위해 "),_("code",[t._v("MS Visual C")]),t._v("의 랜덤함수("),_("code",[t._v("srand()")]),t._v(", "),_("code",[t._v("rand()")]),t._v(")를 사용합니다.")]),t._v(" "),_("p",[_("code",[t._v("srand()")]),t._v("의 초기 값은 앞서 찾은 "),_("code",[t._v("Seed")]),t._v("를 입력하며, "),_("code",[t._v("rand()")]),t._v("함수의 결과값에 따라 배열의 값이 채워집니다.")]),t._v(" "),_("p",[t._v("배열의 값이 채워지는 방식은 아래와 같습니다.")]),t._v(" "),_("ol",[_("li",[_("code",[t._v("srand()")]),t._v(" 초기화 ("),_("code",[t._v("Seed")]),t._v(" 사용)")]),t._v(" "),_("li",[_("code",[t._v("rand()")]),t._v("함수의 결과 값을 이용하여 배열을 채웁니다. 단, "),_("code",[t._v("rand()")]),t._v("함수가 호출되는 순번에 따라 그 사용 방식이 달라집니다.\n"),_("ul",[_("li",[t._v("홀수번째: 배열이 채워지는 값")]),t._v(" "),_("li",[t._v("짝수번째: 배열에 채워지는 횟수")])])]),t._v(" "),_("li",[t._v("홀수번째 "),_("code",[t._v("rand() & 0xFF")]),t._v("의 값을 "),_("code",[t._v("A")]),t._v("라고 하고, 짝수번째 "),_("code",[t._v("(rand() & 0x0F + 1)")]),t._v("의 결과를 "),_("code",[t._v("B")]),t._v("라 할 때 배열의 "),_("code",[t._v("A")]),t._v("값을 "),_("code",[t._v("B")]),t._v("번 횟수만큼 삽입합니다.\n"),_("ul",[_("li",[t._v("예를 들어 "),_("code",[t._v("A")]),t._v("가 "),_("code",[t._v("'a'")]),t._v("이고 "),_("code",[t._v("B")]),t._v("가 "),_("code",[t._v("3")]),t._v("일 경우에 배열에 "),_("code",[t._v("'a'")]),t._v("를 "),_("code",[t._v("3")]),t._v("번 삽입합니다.")])])]),t._v(" "),_("li",[t._v("배열의 크기가 "),_("code",[t._v("256")]),t._v("이 될 때까지 "),_("code",[t._v("1 - 3")]),t._v("을 반복합니다.")])]),t._v(" "),_("p",{attrs:{align:"center"}},[_("img",{attrs:{src:"/images/hwp/docinfo/distribute/seed_array.png"}})]),t._v(" "),_("h2",{attrs:{id:"해시코드-추출하기"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#해시코드-추출하기","aria-hidden":"true"}},[t._v("#")]),t._v(" 해시코드 추출하기")]),t._v(" "),_("p",[t._v("난수 배열을 생성한 다음에는 "),_("a",{attrs:{href:"#%EB%8D%B0%EC%9D%B4%ED%85%A8-%ED%91%9C"}},[t._v("배포용 문서 데이터")]),t._v("를 이용하여 해시코드와 옵션 플래그를 생성할 수 있습니다.")]),t._v(" "),_("p",[t._v("해시코드와 옵션 플래그는 다음의 과정을 통해 생성됩니다.")]),t._v(" "),_("ol",[_("li",[_("code",[t._v("Seed")]),t._v("로 부터 "),_("code",[t._v("offset")]),t._v("을 구합니다. "),_("code",[t._v("offset")]),t._v("은 다음과 값과 같습니다.\n"),_("ul",[_("li",[_("code",[t._v("offset = (Seed & 0x0f) + sizeof(UINT)")])])])]),t._v(" "),_("li",[t._v("난수배열과 "),_("a",{attrs:{href:"#%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%91%9C"}},[t._v("배표용 문서 데이터")]),t._v("를 "),_("code",[t._v("XOR")]),t._v("머지 합니다.")]),t._v(" "),_("li",[_("code",[t._v("XOR")]),t._v("머지된 결과값에서 "),_("code",[t._v("offset")]),t._v("만큼 떨어진 위치의 "),_("code",[t._v("80")]),t._v("바이트가 해시코드이며, 그 다음 "),_("code",[t._v("2")]),t._v("바이트가 옵션 플래그입니다.")])]),t._v(" "),_("div",{staticClass:"tip custom-block"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("p",[t._v("해시코드는 배포용 문서를 만들 때 사용된 암호를 "),_("code",[t._v("SHA1")]),t._v(" 알고리즘으로 변환된 코드입니다.")]),t._v(" "),_("p",[t._v("해당 코드는 배포용 문서를 해제하거나 편집하는 용도로 사용됩니다.")])]),t._v(" "),_("h2",{attrs:{id:"해시코드와-aes-128-알고르짐을-이용하여-레코드-복호화"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#해시코드와-aes-128-알고르짐을-이용하여-레코드-복호화","aria-hidden":"true"}},[t._v("#")]),t._v(" 해시코드와 AES-128 알고르짐을 이용하여 레코드 복호화")]),t._v(" "),_("p",[t._v("해시코드의 처음 "),_("code",[t._v("16")]),t._v("바이트는 본문 레코드를 복호화하는 용도로 사용됩니다.")]),t._v(" "),_("p",[t._v("본문 레코드는 "),_("code",[t._v("AES-128 ECB")]),t._v("를 통해 암호화 되었으므로 동일 알고리즘을 이용하여 복호화할 수 있습니다.")])])},[],!1,null,null,null);e.default=a.exports}}]);